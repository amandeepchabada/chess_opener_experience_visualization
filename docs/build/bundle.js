var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function r(){return Object.create(null)}function o(e){e.forEach(n)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let s;function a(e,t){return s||(s=document.createElement("a")),s.href=t,e===s.href}function c(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(c(t,n))}function f(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}const d="undefined"!=typeof window;let p=d?()=>window.performance.now():()=>Date.now(),g=d?e=>requestAnimationFrame(e):e;const v=new Set;function h(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&g(h)}function m(e,t){e.appendChild(t)}function b(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function x(e){const t=M("style");return function(e,t){m(e.head||e,t)}(b(e),t),t.sheet}function $(e,t,n){e.insertBefore(t,n||null)}function y(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function M(e){return document.createElement(e)}function A(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function E(e){return document.createTextNode(e)}function T(){return E(" ")}function _(){return E("")}function C(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function k(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function N(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function S(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}const P=new Map;let q,I=0;function D(e,t,n,r,o,l,i,s=0){const a=16.666/r;let c="{\n";for(let e=0;e<=1;e+=a){const r=t+(n-t)*l(e);c+=100*e+`%{${i(r,1-r)}}\n`}const u=c+`100% {${i(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${s}`,d=b(e),{stylesheet:p,rules:g}=P.get(d)||function(e,t){const n={stylesheet:x(t),rules:{}};return P.set(e,n),n}(d,e);g[f]||(g[f]=!0,p.insertRule(`@keyframes ${f} ${u}`,p.cssRules.length));const v=e.style.animation||"";return e.style.animation=`${v?`${v}, `:""}${f} ${r}ms linear ${o}ms 1 both`,I+=1,f}function L(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),I-=o,I||g((()=>{I||(P.forEach((e=>{const{stylesheet:t}=e;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.rules={}})),P.clear())})))}function O(e){q=e}function R(){if(!q)throw new Error("Function called outside component initialization");return q}function j(e){R().$$.on_destroy.push(e)}const B=[],z=[],K=[],Q=[],F=Promise.resolve();let U=!1;function G(e){K.push(e)}const W=new Set;let H,V=0;function X(){const e=q;do{for(;V<B.length;){const e=B[V];V++,O(e),Y(e.$$)}for(O(null),B.length=0,V=0;z.length;)z.pop()();for(let e=0;e<K.length;e+=1){const t=K[e];W.has(t)||(W.add(t),t())}K.length=0}while(B.length);for(;Q.length;)Q.pop()();U=!1,W.clear(),O(e)}function Y(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(G)}}function Z(e,t,n){e.dispatchEvent(function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(`${t?"intro":"outro"}${n}`))}const J=new Set;let ee;function te(){ee={r:0,c:[],p:ee}}function ne(){ee.r||o(ee.c),ee=ee.p}function re(e,t){e&&e.i&&(J.delete(e),e.i(t))}function oe(e,t,n,r){if(e&&e.o){if(J.has(e))return;J.add(e),ee.c.push((()=>{J.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}const le={duration:0};function ie(n,r,i,s){let a=r(n,i),c=s?0:1,u=null,f=null,d=null;function m(){d&&L(n,d)}function b(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function x(r){const{delay:l=0,duration:i=300,easing:s=t,tick:x=e,css:$}=a||le,y={start:p()+l,b:r};r||(y.group=ee,ee.r+=1),u||f?f=y:($&&(m(),d=D(n,c,r,i,l,s,$)),r&&x(0,1),u=b(y,i),G((()=>Z(n,r,"start"))),function(e){let t;0===v.size&&g(h),new Promise((n=>{v.add(t={c:e,f:n})}))}((e=>{if(f&&e>f.start&&(u=b(f,i),f=null,Z(n,u.b,"start"),$&&(m(),d=D(n,c,u.b,u.duration,0,s,a.css))),u)if(e>=u.end)x(c=u.b,1-c),Z(n,u.b,"end"),f||(u.b?m():--u.group.r||o(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*s(t/u.duration),x(c,1-c)}return!(!u&&!f)})))}return{run(e){l(a)?(H||(H=Promise.resolve(),H.then((()=>{H=null}))),H).then((()=>{a=a(),x(e)})):x(e)},end(){m(),u=f=null}}}const se="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ae(e){e&&e.c()}function ce(e,t,r,i){const{fragment:s,on_mount:a,on_destroy:c,after_update:u}=e.$$;s&&s.m(t,r),i||G((()=>{const t=a.map(n).filter(l);c?c.push(...t):o(t),e.$$.on_mount=[]})),u.forEach(G)}function ue(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function fe(e,t){-1===e.$$.dirty[0]&&(B.push(e),U||(U=!0,F.then(X)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function de(t,n,l,i,s,a,c,u=[-1]){const f=q;O(t);const d=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:s,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};c&&c(d.root);let p=!1;if(d.ctx=l?l(t,n.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&s(d.ctx[e],d.ctx[e]=o)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](o),p&&fe(t,e)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(y)}else d.fragment&&d.fragment.c();n.intro&&re(t.$$.fragment),ce(t,n.target,n.anchor,n.customElement),X()}O(f)}class pe{$destroy(){ue(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ge=[];function ve(t,n=e){let r;const o=new Set;function l(e){if(i(t,e)&&(t=e,r)){const e=!ge.length;for(const e of o)e[1](),ge.push(e,t);if(e){for(let e=0;e<ge.length;e+=2)ge[e][0](ge[e+1]);ge.length=0}}}return{set:l,update:function(e){l(e(t))},subscribe:function(i,s=e){const a=[i,s];return o.add(a),1===o.size&&(r=n(l)||e),i(t),()=>{o.delete(a),0===o.size&&(r(),r=null)}}}}const he=ve(!1),me=ve("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),be=ve(!1),xe=ve(!1),$e=ve(!1),ye=[{b:105023,w:115498,t:42,nxt:{e7e6:1,g8f6:1}},{b:15,w:115498,t:9263,nxt:{e7e6:1,g8f6:1,f7f5:9,b8a6:1,d8e7:2}},{b:105023,w:984984,t:66,nxt:{e7e6:1,g8f6:1}},{b:0,w:115498,t:9263,nxt:{e7e6:1,g8f6:1}}],we=function(t,n,r){const i=!Array.isArray(t),s=i?[t]:t,a=n.length<2;return u=t=>{let r=!1;const u=[];let f=0,d=e;const p=()=>{if(f)return;d();const r=n(i?u[0]:u,t);a?t(r):d=l(r)?r:e},g=s.map(((e,t)=>c(e,(e=>{u[t]=e,f&=~(1<<t),r&&p()}),(()=>{f|=1<<t}))));return r=!0,p(),function(){o(g),d()}},{subscribe:ve(r,u).subscribe};var u}([me,he],(([e,t])=>{if(!t)return ye;console.log("setting new fen",e,t);const n=["0","1","2","3"].map((n=>null==t[n][e]?[]:t[n][e]));return console.log("new fenDataStore vals",{vals:n}),n}),ye);var Me,Ae,Ee=(Me=function(e,t){t.Chess=function(e){var t="b",n="w",r=-1,o="p",l="b",i="k",s="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",a=["1-0","0-1","1/2-1/2","*"],c={b:[16,32,17,15],w:[-16,-32,-17,-15]},u={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},f=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],d=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],p={p:0,n:1,b:2,r:3,q:4,k:5},g={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},v={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},h={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m={w:[{square:h.a1,flag:v.QSIDE_CASTLE},{square:h.h1,flag:v.KSIDE_CASTLE}],b:[{square:h.a8,flag:v.QSIDE_CASTLE},{square:h.h8,flag:v.KSIDE_CASTLE}]},b=new Array(128),x={w:r,b:r},$=n,y={w:0,b:0},w=r,M=0,A=1,E=[],T={};function _(e){void 0===e&&(e=!1),b=new Array(128),x={w:r,b:r},$=n,y={w:0,b:0},w=r,M=0,A=1,E=[],e||(T={}),q(S())}function C(){k(s)}function k(e,o){void 0===o&&(o=!1);var l=e.split(/\s+/),i=l[0],s=0;if(!N(e).valid)return!1;_(o);for(var a=0;a<i.length;a++){var c=i.charAt(a);if("/"===c)s+=8;else if(-1!=="0123456789".indexOf(c))s+=parseInt(c,10);else{var u=c<"a"?n:t;D({type:c.toLowerCase(),color:u},Z(s)),s++}}return $=l[1],l[2].indexOf("K")>-1&&(y.w|=v.KSIDE_CASTLE),l[2].indexOf("Q")>-1&&(y.w|=v.QSIDE_CASTLE),l[2].indexOf("k")>-1&&(y.b|=v.KSIDE_CASTLE),l[2].indexOf("q")>-1&&(y.b|=v.QSIDE_CASTLE),w="-"===l[3]?r:h[l[3]],M=parseInt(l[4],10),A=parseInt(l[5],10),q(S()),!0}function N(e){var t="No errors.",n="FEN string must contain six space-delimited fields.",r="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",l="4th field (en-passant square) is invalid.",i="3rd field (castling availability) is invalid.",s="2nd field (side to move) is invalid.",a="1st field (piece positions) does not contain 8 '/'-delimited rows.",c="1st field (piece positions) is invalid [consecutive numbers].",u="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",d="Illegal en-passant square",p=e.split(/\s+/);if(6!==p.length)return{valid:!1,error_number:1,error:n};if(isNaN(p[5])||parseInt(p[5],10)<=0)return{valid:!1,error_number:2,error:r};if(isNaN(p[4])||parseInt(p[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(p[3]))return{valid:!1,error_number:4,error:l};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(p[2]))return{valid:!1,error_number:5,error:i};if(!/^(w|b)$/.test(p[1]))return{valid:!1,error_number:6,error:s};var g=p[0].split("/");if(8!==g.length)return{valid:!1,error_number:7,error:a};for(var v=0;v<g.length;v++){for(var h=0,m=!1,b=0;b<g[v].length;b++)if(isNaN(g[v][b])){if(!/^[prnbqkPRNBQK]$/.test(g[v][b]))return{valid:!1,error_number:9,error:u};h+=1,m=!1}else{if(m)return{valid:!1,error_number:8,error:c};h+=parseInt(g[v][b],10),m=!0}if(8!==h)return{valid:!1,error_number:10,error:f}}return"3"==p[3][1]&&"w"==p[1]||"6"==p[3][1]&&"b"==p[1]?{valid:!1,error_number:11,error:d}:{valid:!0,error_number:0,error:t}}function S(){for(var e=0,t="",o=h.a8;o<=h.h1;o++){if(null==b[o])e++;else{e>0&&(t+=e,e=0);var l=b[o].color,i=b[o].type;t+=l===n?i.toUpperCase():i.toLowerCase()}o+1&136&&(e>0&&(t+=e),o!==h.h1&&(t+="/"),e=0,o+=8)}var s="";y.w&v.KSIDE_CASTLE&&(s+="K"),y.w&v.QSIDE_CASTLE&&(s+="Q"),y.b&v.KSIDE_CASTLE&&(s+="k"),y.b&v.QSIDE_CASTLE&&(s+="q"),s=s||"-";var a=w===r?"-":Z(w);return[t,$,s,a,M,A].join(" ")}function P(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(T[e[t]]=e[t+1]);return T}function q(e){E.length>0||(e!==s?(T.SetUp="1",T.FEN=e):(delete T.SetUp,delete T.FEN))}function I(e){var t=b[h[e]];return t?{type:t.type,color:t.color}:null}function D(e,t){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(t in h))return!1;var n=h[t];return(e.type!=i||x[e.color]==r||x[e.color]==n)&&(b[n]={type:e.type,color:e.color},e.type===i&&(x[e.color]=n),q(S()),!0)}function L(e,t,n,r,l){var i={color:$,from:t,to:n,flags:r,piece:e[t].type};return l&&(i.flags|=v.PROMOTION,i.promotion=l),e[n]?i.captured=e[n].type:r&v.EP_CAPTURE&&(i.captured=o),i}function O(e){function t(e,t,n,r,i){if(e[n].type!==o||0!==X(r)&&7!==X(r))t.push(L(e,n,r,i));else for(var s=["q","r",l,"n"],a=0,c=s.length;a<c;a++)t.push(L(e,n,r,i,s[a]))}var n=[],r=$,i=J(r),s={b:1,w:6},a=h.a8,f=h.h1,d=!1,p=void 0===e||!("legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in h))return[];a=f=h[e.square],d=!0}for(var g=a;g<=f;g++)if(136&g)g+=7;else{var m=b[g];if(null!=m&&m.color===r)if(m.type===o){var M=g+c[r][0];for(null==b[M]&&(t(b,n,g,M,v.NORMAL),M=g+c[r][1],s[r]===X(g)&&null==b[M]&&t(b,n,g,M,v.BIG_PAWN)),A=2;A<4;A++)136&(M=g+c[r][A])||(null!=b[M]&&b[M].color===i?t(b,n,g,M,v.CAPTURE):M===w&&t(b,n,g,w,v.EP_CAPTURE))}else for(var A=0,E=u[m.type].length;A<E;A++){var T=u[m.type][A];for(M=g;!(136&(M+=T));){if(null!=b[M]){if(b[M].color===r)break;t(b,n,g,M,v.CAPTURE);break}if(t(b,n,g,M,v.NORMAL),"n"===m.type||"k"===m.type)break}}}if(!d||f===x[r]){if(y[r]&v.KSIDE_CASTLE){var _=(C=x[r])+2;null!=b[C+1]||null!=b[_]||B(i,x[r])||B(i,C+1)||B(i,_)||t(b,n,x[r],_,v.KSIDE_CASTLE)}var C;if(y[r]&v.QSIDE_CASTLE)_=(C=x[r])-2,null!=b[C-1]||null!=b[C-2]||null!=b[C-3]||B(i,x[r])||B(i,C-1)||B(i,_)||t(b,n,x[r],_,v.QSIDE_CASTLE)}if(!p)return n;var k=[];for(g=0,E=n.length;g<E;g++)W(n[g]),z(r)||k.push(n[g]),H();return k}function R(e,t){var n="";if(e.flags&v.KSIDE_CASTLE)n="O-O";else if(e.flags&v.QSIDE_CASTLE)n="O-O-O";else{var r=function(e,t){for(var n=O({legal:!t}),r=e.from,o=e.to,l=e.piece,i=0,s=0,a=0,c=0,u=n.length;c<u;c++){var f=n[c].from,d=n[c].to;l===n[c].piece&&r!==f&&o===d&&(i++,X(r)===X(f)&&s++,Y(r)===Y(f)&&a++)}return i>0?s>0&&a>0?Z(r):a>0?Z(r).charAt(1):Z(r).charAt(0):""}(e,t);e.piece!==o&&(n+=e.piece.toUpperCase()+r),e.flags&(v.CAPTURE|v.EP_CAPTURE)&&(e.piece===o&&(n+=Z(e.from)[0]),n+="x"),n+=Z(e.to),e.flags&v.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return W(e),K()&&(Q()?n+="#":n+="+"),H(),n}function j(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function B(e,r){for(var l=h.a8;l<=h.h1;l++)if(136&l)l+=7;else if(null!=b[l]&&b[l].color===e){var i=b[l],s=l-r,a=s+119;if(f[a]&1<<p[i.type]){if(i.type===o){if(s>0){if(i.color===n)return!0}else if(i.color===t)return!0;continue}if("n"===i.type||"k"===i.type)return!0;for(var c=d[a],u=l+c,g=!1;u!==r;){if(null!=b[u]){g=!0;break}u+=c}if(!g)return!0}}return!1}function z(e){return B(J(e),x[e])}function K(){return z($)}function Q(){return K()&&0===O().length}function F(){return!K()&&0===O().length}function U(){for(var e={},t=[],n=0,r=0,o=h.a8;o<=h.h1;o++)if(r=(r+1)%2,136&o)o+=7;else{var i=b[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===l&&t.push(r),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var s=0,a=t.length;for(o=0;o<a;o++)s+=t[o];if(0===s||s===a)return!0}return!1}function G(){for(var e=[],t={},n=!1;;){var r=H();if(!r)break;e.push(r)}for(;;){var o=S().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,t[o]>=3&&(n=!0),!e.length)break;W(e.pop())}return n}function W(e){var n=$,l=J(n);if(function(e){E.push({move:e,kings:{b:x.b,w:x.w},turn:$,castling:{b:y.b,w:y.w},ep_square:w,half_moves:M,move_number:A})}(e),b[e.to]=b[e.from],b[e.from]=null,e.flags&v.EP_CAPTURE&&($===t?b[e.to-16]=null:b[e.to+16]=null),e.flags&v.PROMOTION&&(b[e.to]={type:e.promotion,color:n}),b[e.to].type===i){if(x[b[e.to].color]=e.to,e.flags&v.KSIDE_CASTLE){var s=e.to-1,a=e.to+1;b[s]=b[a],b[a]=null}else e.flags&v.QSIDE_CASTLE&&(s=e.to+1,a=e.to-2,b[s]=b[a],b[a]=null);y[n]=""}if(y[n])for(var c=0,u=m[n].length;c<u;c++)if(e.from===m[n][c].square&&y[n]&m[n][c].flag){y[n]^=m[n][c].flag;break}if(y[l])for(c=0,u=m[l].length;c<u;c++)if(e.to===m[l][c].square&&y[l]&m[l][c].flag){y[l]^=m[l][c].flag;break}w=e.flags&v.BIG_PAWN?"b"===$?e.to-16:e.to+16:r,e.piece===o||e.flags&(v.CAPTURE|v.EP_CAPTURE)?M=0:M++,$===t&&A++,$=J($)}function H(){var e=E.pop();if(null==e)return null;var n=e.move;x=e.kings,$=e.turn,y=e.castling,w=e.ep_square,M=e.half_moves,A=e.move_number;var r,l,i=$,s=J($);if(b[n.from]=b[n.to],b[n.from].type=n.piece,b[n.to]=null,n.flags&v.CAPTURE)b[n.to]={type:n.captured,color:s};else if(n.flags&v.EP_CAPTURE){var a;a=i===t?n.to-16:n.to+16,b[a]={type:o,color:s}}return n.flags&(v.KSIDE_CASTLE|v.QSIDE_CASTLE)&&(n.flags&v.KSIDE_CASTLE?(r=n.to+1,l=n.to-1):n.flags&v.QSIDE_CASTLE&&(r=n.to-2,l=n.to+1),b[r]=b[l],b[l]=null),n}function V(e,t){var n=j(e);if(t){var r=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(r)var o=r[1],l=r[2],i=r[3],s=r[4]}for(var a=O(),c=0,u=a.length;c<u;c++){if(n===j(R(a[c]))||t&&n===j(R(a[c],!0)))return a[c];if(r&&(!o||o.toLowerCase()==a[c].piece)&&h[l]==a[c].from&&h[i]==a[c].to&&(!s||s.toLowerCase()==a[c].promotion))return a[c]}return null}function X(e){return e>>4}function Y(e){return 15&e}function Z(e){var t=Y(e),n=X(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function J(e){return e===n?t:n}function ee(e){var t=te(e);t.san=R(t,!1),t.to=Z(t.to),t.from=Z(t.from);var n="";for(var r in v)v[r]&t.flags&&(n+=g[r]);return t.flags=n,t}function te(e){var t=e instanceof Array?[]:{};for(var n in e)t[n]="object"==typeof n?te(e[n]):e[n];return t}function ne(e){return e.replace(/^\s+|\s+$/g,"")}function re(e){for(var t=O({legal:!1}),n=0,r=$,o=0,l=t.length;o<l;o++)W(t[o]),z(r)||(e-1>0?n+=re(e-1):n++),H();return n}return k(void 0===e?s:e),{WHITE:n,BLACK:t,PAWN:o,KNIGHT:"n",BISHOP:l,ROOK:"r",QUEEN:"q",KING:i,SQUARES:function(){for(var e=[],t=h.a8;t<=h.h1;t++)136&t?t+=7:e.push(Z(t));return e}(),FLAGS:g,load:function(e){return k(e)},reset:function(){return C()},moves:function(e){for(var t=O(e),n=[],r=0,o=t.length;r<o;r++)void 0!==e&&"verbose"in e&&e.verbose?n.push(ee(t[r])):n.push(R(t[r],!1));return n},in_check:function(){return K()},in_checkmate:function(){return Q()},in_stalemate:function(){return F()},in_draw:function(){return M>=100||F()||U()||G()},insufficient_material:function(){return U()},in_threefold_repetition:function(){return G()},game_over:function(){return M>=100||Q()||F()||U()||G()},validate_fen:function(e){return N(e)},fen:function(){return S()},board:function(){for(var e=[],t=[],n=h.a8;n<=h.h1;n++)null==b[n]?t.push(null):t.push({type:b[n].type,color:b[n].color}),n+1&136&&(e.push(t),t=[],n+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,r=[],o=!1;for(var l in T)r.push("["+l+' "'+T[l]+'"]'+t),o=!0;o&&E.length&&r.push(t);for(var i=[];E.length>0;)i.push(H());for(var s=[],a="";i.length>0;){var c=i.pop();E.length||"b"!==c.color?"w"===c.color&&(a.length&&s.push(a),a=A+"."):a=A+". ...",a=a+" "+R(c,!1),W(c)}if(a.length&&s.push(a),void 0!==T.Result&&s.push(T.Result),0===n)return r.join("")+s.join(" ");var u=0;for(l=0;l<s.length;l++)u+s[l].length>n&&0!==l?(" "===r[r.length-1]&&r.pop(),r.push(t),u=0):0!==l&&(r.push(" "),u++),r.push(s[l]),u+=s[l].length;return r.join("")},load_pgn:function(e,t){var n=void 0!==t&&"sloppy"in t&&t.sloppy;function r(e){return e.replace(/\\/g,"\\")}var o="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",l=new RegExp("^(\\[((?:"+r(o)+")|.)*\\])(?:"+r(o)+"){2}"),i=l.test(e)?l.exec(e)[1]:"";C();var s=function(e,t){for(var n="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",o={},l=e.split(new RegExp(r(n))),i="",s="",a=0;a<l.length;a++)i=l[a].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),s=l[a].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),ne(i).length>0&&(o[i]=s);return o}(i,t);for(var c in s)P([c,s[c]]);if(!("1"!==s.SetUp||"FEN"in s&&k(s.FEN,!0)))return!1;var u=e.replace(i,"").replace(new RegExp(r(o),"g")," ");u=u.replace(/(\{[^}]+\})+?/g,"");for(var f=/(\([^\(\)]+\))+?/g;f.test(u);)u=u.replace(f,"");var d=ne(u=(u=(u=u.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));d=d.join(",").replace(/,,+/g,",").split(",");for(var p="",g=0;g<d.length-1;g++){if(null==(p=V(d[g],n)))return!1;W(p)}if(p=d[d.length-1],a.indexOf(p)>-1)(function(e){for(var t in e)return!0;return!1})(T)&&void 0===T.Result&&P(["Result",p]);else{if(null==(p=V(p,n)))return!1;W(p)}return!0},header:function(){return P(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",t=h.a8;t<=h.h1;t++){if(0===Y(t)&&(e+=" "+"87654321"[X(t)]+" |"),null==b[t])e+=" . ";else{var r=b[t].type;e+=" "+(b[t].color===n?r.toUpperCase():r.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return $},move:function(e,t){var n=void 0!==t&&"sloppy"in t&&t.sloppy,r=null;if("string"==typeof e)r=V(e,n);else if("object"==typeof e)for(var o=O(),l=0,i=o.length;l<i;l++)if(e.from===Z(o[l].from)&&e.to===Z(o[l].to)&&(!("promotion"in o[l])||e.promotion===o[l].promotion)){r=o[l];break}if(!r)return null;var s=ee(r);return W(r),s},undo:function(){var e=H();return e?ee(e):null},clear:function(){return _()},put:function(e,t){return D(e,t)},get:function(e){return I(e)},remove:function(e){return function(e){var t=I(e);return b[h[e]]=null,t&&t.type===i&&(x[t.color]=r),q(S()),t}(e)},perft:function(e){return re(e)},square_color:function(e){if(e in h){var t=h[e];return(X(t)+Y(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],n=[],r=(void 0!==e&&"verbose"in e&&e.verbose);E.length>0;)t.push(H());for(;t.length>0;){var o=t.pop();r?n.push(ee(o)):n.push(R(o)),W(o)}return n}}}},Me(Ae={exports:{}},Ae.exports),Ae.exports);const{document:Te}=se;function _e(e){let t;return{c(){t=M("div"),t.textContent="There was an error rendering the chessboard, please reload the page...",S(t,"width","400px"),S(t,"height","400px")},m(e,n){$(e,t,n)},d(e){e&&y(t)}}}function Ce(t){let n,r,l,i,s,c,u,f,d,p,g,v,h,b,x,w,A,_,N,P,q,I,D,L,O,R,j,B,z,K,Q,F,U=null==t[0]&&_e();return{c(){n=M("script"),l=M("link"),i=M("script"),c=T(),u=M("div"),U&&U.c(),f=T(),d=M("div"),d.innerHTML='<p id="who-plays"></p>',p=T(),g=M("div"),v=T(),h=M("div"),b=M("button"),b.textContent="Back",x=T(),w=M("button"),w.textContent="Start Position",A=T(),_=M("div"),N=M("input"),P=T(),q=M("button"),q.textContent="Copy Position",I=T(),D=M("div"),L=M("input"),O=T(),R=M("button"),R.textContent="Set Position",j=T(),B=M("label"),z=M("input"),K=E("  Only Legal Moves"),a(n.src,r="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js")||k(n,"src","https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"),k(l,"rel","stylesheet"),k(l,"href","./chessboard-1.0.0.min.css"),a(i.src,s="./chessboard-1.0.0.min.js")||k(i,"src","./chessboard-1.0.0.min.js"),k(g,"id","board"),S(g,"width","400px"),k(b,"id","backBtn"),k(b,"class","svelte-14feznf"),k(w,"id","startBtn"),k(w,"class","svelte-14feznf"),k(h,"class","btn-div svelte-14feznf"),k(N,"type","text"),N.value="",k(N,"id","copy-fen"),k(N,"class","svelte-14feznf"),S(q,"width","160px"),k(_,"id","fen-copy-div"),k(_,"class","svelte-14feznf"),k(L,"type","text"),L.value="",k(L,"id","get-fen"),k(L,"class","svelte-14feznf"),k(R,"id","get-fen-btn"),k(R,"class","svelte-14feznf"),k(D,"id","fen-get-div"),k(D,"class","svelte-14feznf"),k(z,"type","checkbox"),k(z,"id","legal"),k(z,"name","legal"),z.value="yes",k(B,"for","legal"),k(u,"class","container svelte-14feznf")},m(e,r){m(Te.head,n),m(Te.head,l),m(Te.head,i),$(e,c,r),$(e,u,r),U&&U.m(u,null),m(u,f),m(u,d),m(u,p),m(u,g),m(u,v),m(u,h),m(h,b),m(h,x),m(h,w),m(u,A),m(u,_),m(_,N),m(_,P),m(_,q),m(u,I),m(u,D),m(D,L),m(D,O),m(D,R),m(u,j),m(u,B),m(B,z),m(B,K),Q||(F=[C(i,"load",t[1]),C(b,"click",t[4]),C(w,"click",t[1]),C(q,"click",Ie),C(R,"click",t[2]),C(z,"click",t[3])],Q=!0)},p(e,[t]){null==e[0]?U||(U=_e(),U.c(),U.m(u,f)):U&&(U.d(1),U=null)},i:e,o:e,d(e){y(n),y(l),y(i),e&&y(c),e&&y(u),U&&U.d(),Q=!1,o(F)}}}let ke="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";function Ne(e,t){}function Se(e){var t=document.querySelector("#board .square-"+e),n="#a9a9a9";t.getAttribute("class").includes("black-3c85d")&&(n="#696969"),t.style.background=n}function Pe(e,t){qe()}function qe(){for(var e=document.querySelectorAll("#board .square-55d63"),t=0;t<e.length;t++)e[t].style.background=""}function Ie(){var e=document.querySelector("#copy-fen");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value)}function De(e,t,n){var r;let o;var l,i=!0;j(be.subscribe((e=>{console.log("Here",e);var t=document.querySelector("#board .square-"+e),n=document.createElement("div");null!=t?(n.setAttribute("class","sq_div"),n.style.height="80%",n.style.border="5px solid #0000FF",t.appendChild(n)):null!=(n=document.querySelector(".sq_div"))&&n.remove()})));j(me.subscribe((e=>{e!=o&&r&&r.position(e)})));function s(){l=new Ee.Chess,n(0,r=Chessboard("board",{draggable:!0,position:"start",onDrop:a,onChange:c,onDragStart:Ne,onMouseoverSquare:u,onMouseoutSquare:Pe,sparePieces:!1,dropOffBoard:1==i?"snapback":"trash"})),o=r.fen(),f(),me.set(o),p()}function a(e,t,n,o,s,a){if(Chessboard.objToFen(s)==Chessboard.objToFen(o))return!1;qe();var c=l.move({from:e,to:t,promotion:"q"});if(i){if(console.log("Move: ",c),null===c)return"snapback";"O-O"==c.san&&("w"==c.color?r.move("h1-f1"):"b"==c.color&&r.move("h8-f8")),"O-O-O"==c.san&&("w"==c.color?r.move("a1-d1"):"b"==c.color&&r.move("a8-d8"))}}function c(e,t){console.log("On Change",Chessboard.objToFen(t)),o=Chessboard.objToFen(t),f(),console.log("Turn to Play: ",l.turn()),me.set(o),me.subscribe((e=>{console.log("After Change, Current Fen: ",e)})),d(i),p()}function u(e,t){var n=l.moves({square:e,verbose:!0});Se(e);for(var r=0;r<n.length;r++)Se(n[r].to)}function f(){var e=document.querySelector("#copy-fen");e.value=null==o?ke:o}function d(e){const t=document.createElement("h1");var n,r=document.querySelector("#who-plays");0==e?(r.innerHTML="",n=document.createTextNode("Move pieces to update the visualization.")):1==e&&(r.innerHTML="",n=document.createTextNode("Move of: "+l.turn())),t.appendChild(n),r.appendChild(t)}function p(){$e.set(l.moves({verbose:!0}))}return j($e.subscribe((e=>{console.log("Legal Moves: ",e)}))),function(e){R().$$.on_mount.push(e)}((()=>{console.log("Mounted"),console.log("Curr_fen",me,"start"),f(),d(!1)})),[r,s,function(){console.log("In getBoardPos()");var e=document.querySelector("#get-fen");let t=e.value;""==t&&r.clear(!0),r.position(t,!0),e.value=""},function(){var e=document.querySelector("#legal");console.log("LegalChechBox: ",e.checked),i=e.checked,s(),d(i)},function(){o==ke&&0==l.history().length?alert("No Moves played previously"):(l.undo(),r.position(l.fen(),!0))}]}class Le extends pe{constructor(e){super(),de(this,e,De,Ce,i,{})}}function Oe(t){let n;return{c(){n=M("div"),n.innerHTML='<h1 class="svelte-i38bul">Chessboard Visualization:\n        A project for CS549 Visual Analytics</h1>',k(n,"class","container svelte-i38bul")},m(e,t){$(e,n,t)},p:e,i:e,o:e,d(e){e&&y(n)}}}class Re extends pe{constructor(e){super(),de(this,e,null,Oe,i,{})}}function je(e){let t,n;return{c(){t=M("div"),n=E(e[0]),S(t,"top",e[3]+"px"),S(t,"left",e[2]+"px"),k(t,"class","tooltip svelte-ehxw5s")},m(e,r){$(e,t,r),m(t,n)},p(e,r){1&r&&N(n,e[0]),8&r&&S(t,"top",e[3]+"px"),4&r&&S(t,"left",e[2]+"px")},d(e){e&&y(t)}}}function Be(e){let t,n,r,l,i,s;const a=e[8].default,c=function(e,t,n,r){if(e){const o=f(e,t,n,r);return e[0](o)}}(a,e,e[7],null);let u=e[1]&&je(e);return{c(){t=M("div"),c&&c.c(),n=T(),u&&u.c(),r=_()},m(o,a){$(o,t,a),c&&c.m(t,null),$(o,n,a),u&&u.m(o,a),$(o,r,a),l=!0,i||(s=[C(t,"mouseover",e[4]),C(t,"mouseleave",e[6]),C(t,"mousemove",e[5])],i=!0)},p(e,[t]){c&&c.p&&(!l||128&t)&&function(e,t,n,r,o,l){if(o){const i=f(t,n,r,l);e.p(i,o)}}(c,a,e,e[7],l?function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(a,e[7],t,null):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[7]),null),e[1]?u?u.p(e,t):(u=je(e),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},i(e){l||(re(c,e),l=!0)},o(e){oe(c,e),l=!1},d(e){e&&y(t),c&&c.d(e),e&&y(n),u&&u.d(e),e&&y(r),i=!1,o(s)}}}function ze(e,t,n){let r,o,{$$slots:l={},$$scope:i}=t,{title:s=""}=t,a=!1;return e.$$set=e=>{"title"in e&&n(0,s=e.title),"$$scope"in e&&n(7,i=e.$$scope)},[s,a,r,o,function(e){n(1,a=!0),n(2,r=e.pageX+5),n(3,o=e.pageY+5)},function(e){n(2,r=e.pageX+5),n(3,o=e.pageY+5)},function(){n(1,a=!1)},i,l]}class Ke extends pe{constructor(e){super(),de(this,e,ze,Be,i,{title:0})}}function Qe(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function Fe(e,{delay:t=0,speed:n,duration:r,easing:o=Qe}={}){let l=e.getTotalLength();const i=getComputedStyle(e);return"butt"!==i.strokeLinecap&&(l+=parseInt(i.strokeWidth)),void 0===r?r=void 0===n?800:l/n:"function"==typeof r&&(r=r(l)),{delay:t,duration:r,easing:o,css:(e,t)=>`stroke-dasharray: ${e*l} ${t*l}`}}function Ue(e,t,n){const r=e.slice();return r[3]=t[n],r[5]=n,r}function Ge(e,t,n){const r=e.slice();return r[3]=t[n],r[5]=n,r}function We(t){let n;return{c(){n=M("p"),n.textContent="No games found"},m(e,t){$(e,n,t)},p:e,d(e){e&&y(n)}}}function He(e){let t,n,r,o=0!=e[3].b&&Ve(e),l=0!=e[3].t&&Xe(e),i=0!=e[3].w&&Ye(e);return{c(){o&&o.c(),t=T(),l&&l.c(),n=T(),i&&i.c(),r=_()},m(e,s){o&&o.m(e,s),$(e,t,s),l&&l.m(e,s),$(e,n,s),i&&i.m(e,s),$(e,r,s)},p(e,s){0!=e[3].b?o?o.p(e,s):(o=Ve(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),0!=e[3].t?l?l.p(e,s):(l=Xe(e),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),0!=e[3].w?i?i.p(e,s):(i=Ye(e),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(e){o&&o.d(e),e&&y(t),l&&l.d(e),e&&y(n),i&&i.d(e),e&&y(r)}}}function Ve(e){let t,n,r,o=e[3].b+"";return{c(){t=M("div"),n=E(o),r=E("%"),k(t,"class","bar val-a svelte-i7n4qd"),S(t,"flex-basis",e[3].b+"%")},m(e,o){$(e,t,o),m(t,n),m(t,r)},p(e,r){1&r&&o!==(o=e[3].b+"")&&N(n,o),1&r&&S(t,"flex-basis",e[3].b+"%")},d(e){e&&y(t)}}}function Xe(e){let t,n,r,o=e[3].t+"";return{c(){t=M("div"),n=E(o),r=E("%"),k(t,"class","bar val-b svelte-i7n4qd"),S(t,"flex-basis",e[3].t+"%")},m(e,o){$(e,t,o),m(t,n),m(t,r)},p(e,r){1&r&&o!==(o=e[3].t+"")&&N(n,o),1&r&&S(t,"flex-basis",e[3].t+"%")},d(e){e&&y(t)}}}function Ye(e){let t,n,r,o=e[3].w+"";return{c(){t=M("div"),n=E(o),r=E("%"),k(t,"class","bar val-c svelte-i7n4qd"),S(t,"flex-basis",e[3].w+"%")},m(e,o){$(e,t,o),m(t,n),m(t,r)},p(e,r){1&r&&o!==(o=e[3].w+"")&&N(n,o),1&r&&S(t,"flex-basis",e[3].w+"%")},d(e){e&&y(t)}}}function Ze(e){let t,n,r,o,l,i,s,a=e[1][e[5]]+"";function c(e,t){return e[3].b+e[3].t+e[3].w!=0?He:We}let u=c(e),f=u(e);return{c(){t=M("div"),n=M("div"),r=M("p"),o=E(a),l=T(),i=M("div"),f.c(),s=T(),k(r,"text-align","right"),k(n,"class","label svelte-i7n4qd"),k(i,"class","bar-container svelte-i7n4qd"),k(i,"id","results-by-exp-bars"),k(t,"class","row svelte-i7n4qd")},m(e,a){$(e,t,a),m(t,n),m(n,r),m(r,o),m(t,l),m(t,i),f.m(i,null),$(e,s,a)},p(e,t){u===(u=c(e))&&f?f.p(e,t):(f.d(1),f=u(e),f&&(f.c(),f.m(i,null)))},d(e){e&&y(t),f.d(),e&&y(s)}}}function Je(e){let t,n;return t=new Ke({props:{title:"Game counts for "+(e[1][e[5]]||0)+": \r\n\r\n              Black- "+(e[3].bG||0)+"\r\n              Tie- "+(e[3].tG||0)+"\r\n              White- "+(e[3].wG||0)+" ",$$slots:{default:[Ze]},$$scope:{ctx:e}}}),{c(){ae(t.$$.fragment)},m(e,r){ce(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.title="Game counts for "+(e[1][e[5]]||0)+": \r\n\r\n              Black- "+(e[3].bG||0)+"\r\n              Tie- "+(e[3].tG||0)+"\r\n              White- "+(e[3].wG||0)+" "),129&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(re(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function et(t){let n;return{c(){n=M("p"),n.textContent="No games found"},m(e,t){$(e,n,t)},p:e,d(e){e&&y(n)}}}function tt(e){let t,n,r,o=(e[3].popularity||0)+"";return{c(){t=M("div"),n=E(o),r=E("%"),k(t,"class","bar val-"+[e[5]]+" svelte-i7n4qd"),S(t,"flex-basis",(Math.round(e[3].popularity/Math.max(...e[0].map(lt))*100)||0)+"%")},m(e,o){$(e,t,o),m(t,n),m(t,r)},p(e,r){1&r&&o!==(o=(e[3].popularity||0)+"")&&N(n,o),1&r&&S(t,"flex-basis",(Math.round(e[3].popularity/Math.max(...e[0].map(lt))*100)||0)+"%")},d(e){e&&y(t)}}}function nt(e){let t,n,r,o,l,i,s,a=e[1][e[5]]+"";function c(e,t){return 0!=e[0][e[5]].total?tt:et}let u=c(e),f=u(e);return{c(){t=M("div"),n=M("div"),r=M("p"),o=E(a),l=T(),i=M("div"),f.c(),s=T(),k(r,"text-align","right"),k(n,"class","label svelte-i7n4qd"),k(i,"class","bar-container svelte-i7n4qd"),k(t,"class","row svelte-i7n4qd")},m(e,a){$(e,t,a),m(t,n),m(n,r),m(r,o),m(t,l),m(t,i),f.m(i,null),$(e,s,a)},p(e,t){u===(u=c(e))&&f?f.p(e,t):(f.d(1),f=u(e),f&&(f.c(),f.m(i,null)))},d(e){e&&y(t),f.d(),e&&y(s)}}}function rt(e){let t,n;return t=new Ke({props:{title:"      Game counts: \r\n\r\n      Beginner- "+(e[0][0].total||0)+"\r\n      Intermediate- "+(e[0][1].total||0)+"\r\n      Advanced- "+(e[0][2].total||0)+"\r\n      Pro- "+(e[0][3].total||0),$$slots:{default:[nt]},$$scope:{ctx:e}}}),{c(){ae(t.$$.fragment)},m(e,r){ce(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.title="      Game counts: \r\n\r\n      Beginner- "+(e[0][0].total||0)+"\r\n      Intermediate- "+(e[0][1].total||0)+"\r\n      Advanced- "+(e[0][2].total||0)+"\r\n      Pro- "+(e[0][3].total||0)),129&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(re(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function ot(e){let t,n,r,o,l,i,s,a,c,u,f,d,p,g=e[0],v=[];for(let t=0;t<g.length;t+=1)v[t]=Je(Ge(e,g,t));const h=e=>oe(v[e],1,1,(()=>{v[e]=null}));let b=e[0],x=[];for(let t=0;t<b.length;t+=1)x[t]=rt(Ue(e,b,t));const A=e=>oe(x[e],1,1,(()=>{x[e]=null}));return{c(){t=M("div"),n=M("h1"),n.textContent="Game Results by Experience Level",r=T(),o=M("h3"),o.textContent="Eventual outcome for games that reach this position",l=T(),i=M("div");for(let e=0;e<v.length;e+=1)v[e].c();s=T(),a=M("h1"),a.textContent="Position Popularity by Experience Level",c=T(),u=M("h3"),u.textContent="% of games that reach this position",f=T(),d=M("div");for(let e=0;e<x.length;e+=1)x[e].c();k(i,"class","container1 svelte-i7n4qd"),k(a,"align","center"),k(a,"font-size","28"),k(d,"class","container1 svelte-i7n4qd"),k(t,"align","center"),k(t,"class","container svelte-i7n4qd")},m(e,g){$(e,t,g),m(t,n),m(t,r),m(t,o),m(t,l),m(t,i);for(let e=0;e<v.length;e+=1)v[e].m(i,null);m(t,s),m(t,a),m(t,c),m(t,u),m(t,f),m(t,d);for(let e=0;e<x.length;e+=1)x[e].m(d,null);p=!0},p(e,[t]){if(3&t){let n;for(g=e[0],n=0;n<g.length;n+=1){const r=Ge(e,g,n);v[n]?(v[n].p(r,t),re(v[n],1)):(v[n]=Je(r),v[n].c(),re(v[n],1),v[n].m(i,null))}for(te(),n=g.length;n<v.length;n+=1)h(n);ne()}if(3&t){let n;for(b=e[0],n=0;n<b.length;n+=1){const r=Ue(e,b,n);x[n]?(x[n].p(r,t),re(x[n],1)):(x[n]=rt(r),x[n].c(),re(x[n],1),x[n].m(d,null))}for(te(),n=b.length;n<x.length;n+=1)A(n);ne()}},i(e){if(!p){for(let e=0;e<g.length;e+=1)re(v[e]);for(let e=0;e<b.length;e+=1)re(x[e]);p=!0}},o(e){v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)oe(v[e]);x=x.filter(Boolean);for(let e=0;e<x.length;e+=1)oe(x[e]);p=!1},d(e){e&&y(t),w(v,e),w(x,e)}}}const lt=e=>e.popularity;function it(e,t,n){let r=[];return j(we.subscribe((e=>{let t=[161763,700261,444771,88547];n(0,r=e.map(((e,n)=>{let r=[e.b,e.t,e.w],o=e.b+e.w+e.t,l=(o/t[n]*100).toFixed(2)||0;return{g:r,bG:e.b||0,b:Math.round(e.b/o*100)||0,wG:e.w||0,w:Math.round(e.w/o*100)||0,tG:e.t||0,t:Math.round(e.t/o*100)||0,total:o||0,popularity:l||0,gameTotal:t||0}})))}))),console.table({posData:r}),[r,["Beginner","Intermediate","Advanced","Pro"]]}class st extends pe{constructor(e){super(),de(this,e,it,ot,i,{})}}const at={B:"#ffffb3",N:"#bebada",Q:"#fb8072",R:"#80b1d3",K:"#fdb462"},ct=[["Bishop","#ffffb3"],["Knight","#bebada"],["Queen","#fb8072"],["Rook","#80b1d3"],["King","#fdb462"],["Pawn","#b3de69"]];function ut({i:e,san:t}){return t?function(e){return at[e[0]]||"#b3de69"}(t):function(e){const t=["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#bc80bd","#ccebc5","#ffed6f"];return t[e%t.length]}(e)}function ft(e){let t,n,r;return{c(){t=A("text"),n=E(e[5]),k(t,"transform",r="translate(18,"+((e[6]-e[7]+e[7]/2)*e[9]/e[4]+5)+")")},m(e,r){$(e,t,r),m(t,n)},p(e,o){32&o&&N(n,e[5]),208&o&&r!==(r="translate(18,"+((e[6]-e[7]+e[7]/2)*e[9]/e[4]+5)+")")&&k(t,"transform",r)},d(e){e&&y(t)}}}function dt(t){let n,r,i,s,a,c,u,f,d,p=t[7]/t[4]*t[9]>20&&ft(t);return{c(){n=A("g"),r=A("rect"),p&&p.c(),k(r,"width",t[10]),k(r,"height",i=t[7]/t[4]*t[9]),k(r,"transform",s="translate(0,"+(t[6]-t[7])/t[4]*t[9]+")"),k(r,"fill",a=t[8]?ut({san:t[5]}):ut({i:t[0]})),k(r,"stroke",c=t[8]?"black":void 0),k(n,"id",u=`bar-${t[5]}`),k(n,"class","bar svelte-q2qqok")},m(e,o){$(e,n,o),m(n,r),p&&p.m(n,null),f||(d=[C(n,"mouseenter",t[13]),C(n,"mouseleave",(function(){l(t[2])&&t[2].apply(this,arguments)})),C(n,"click",t[11])],f=!0)},p(e,[o]){t=e,144&o&&i!==(i=t[7]/t[4]*t[9])&&k(r,"height",i),208&o&&s!==(s="translate(0,"+(t[6]-t[7])/t[4]*t[9]+")")&&k(r,"transform",s),289&o&&a!==(a=t[8]?ut({san:t[5]}):ut({i:t[0]}))&&k(r,"fill",a),256&o&&c!==(c=t[8]?"black":void 0)&&k(r,"stroke",c),t[7]/t[4]*t[9]>20?p?p.p(t,o):(p=ft(t),p.c(),p.m(n,null)):p&&(p.d(1),p=null),32&o&&u!==(u=`bar-${t[5]}`)&&k(n,"id",u)},i:e,o:e,d(e){e&&y(n),p&&p.d(),f=!1,o(d)}}}function pt(e,t,n){let r,o,l,i,s;u(e,xe,(e=>n(8,s=e)));let{i:a}=t,{data:c}=t,{hideTooltip:f,showTooltip:d}=t,{nextMovesTotal:p}=t,{sizing:g}=t,v=!0;const h=setInterval((()=>v=!v),500);j((()=>clearInterval(h)));const{w:m,h:b,bw:x}=g;return e.$$set=e=>{"i"in e&&n(0,a=e.i),"data"in e&&n(1,c=e.data),"hideTooltip"in e&&n(2,f=e.hideTooltip),"showTooltip"in e&&n(3,d=e.showTooltip),"nextMovesTotal"in e&&n(4,p=e.nextMovesTotal),"sizing"in e&&n(12,g=e.sizing)},e.$$.update=()=>{2&e.$$.dirty&&n(7,({fen:r,count:o,accCount:l,san:i}=c),o,(n(6,l),n(1,c)),(n(5,i),n(1,c)))},[a,c,f,d,p,i,l,o,s,b,x,function(){me.set(r),f()},g,e=>d(e,c)]}class gt extends pe{constructor(e){super(),de(this,e,pt,dt,i,{i:0,data:1,hideTooltip:2,showTooltip:3,nextMovesTotal:4,sizing:12})}}function vt(e,t,n){const r=e.slice();return r[27]=t[n],r[29]=n,r}function ht(e){let t,n,r,o,l,i;return{c(){t=A("path"),k(t,"d",n=`M${e[27].x1},${e[27].y1} C0${e[2]},${e[27].y1} 0,${e[27].y2} ${e[27].x2},${e[27].y2}`),k(t,"fill","none"),k(t,"stroke",r=e[3](e[27])),k(t,"stroke-width",o=e[27].t)},m(e,n){$(e,t,n),i=!0},p(l,s){e=l,(!i||1&s&&n!==(n=`M${e[27].x1},${e[27].y1} C0${e[2]},${e[27].y1} 0,${e[27].y2} ${e[27].x2},${e[27].y2}`))&&k(t,"d",n),(!i||1&s&&r!==(r=e[3](e[27])))&&k(t,"stroke",r),(!i||1&s&&o!==(o=e[27].t))&&k(t,"stroke-width",o)},i(n){i||(G((()=>{l||(l=ie(t,Fe,{duration:300,delay:100*(e[0].length-e[29])},!0)),l.run(1)})),i=!0)},o(n){l||(l=ie(t,Fe,{duration:300,delay:100*(e[0].length-e[29])},!1)),l.run(0),i=!1},d(e){e&&y(t),e&&l&&l.end()}}}function mt(e){let t,n,r,o=e[0].reverse(),l=[];for(let t=0;t<o.length;t+=1)l[t]=ht(vt(e,o,t));const i=e=>oe(l[e],1,1,(()=>{l[e]=null}));return{c(){t=A("g");for(let e=0;e<l.length;e+=1)l[e].c();k(t,"id",n=`bar-${e[1]}`),k(t,"class","bar svelte-1uesnla")},m(e,n){$(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null);r=!0},p(e,[s]){if(13&s){let n;for(o=e[0].reverse(),n=0;n<o.length;n+=1){const r=vt(e,o,n);l[n]?(l[n].p(r,s),re(l[n],1)):(l[n]=ht(r),l[n].c(),re(l[n],1),l[n].m(t,null))}for(te(),n=o.length;n<l.length;n+=1)i(n);ne()}(!r||2&s&&n!==(n=`bar-${e[1]}`))&&k(t,"id",n)},i(e){if(!r){for(let e=0;e<o.length;e+=1)re(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)oe(l[e]);r=!1},d(e){e&&y(t),w(l,e)}}}function bt(e,t,n){let r,o,l,i,s,a,c;u(e,xe,(e=>n(18,c=e)));let{tooltipData:f}=t,{nextMovesTotal:d}=t,{aggNextMove:p}=t,{nextMovesArr:g}=t,{nextMovesTotal2:v}=t,{aggNextMove2:h}=t,{nextMovesArr2:m}=t,{sizing:b}=t;const{w:x,h:$,bw:y,th:w}=b;return e.$$set=e=>{"tooltipData"in e&&n(4,f=e.tooltipData),"nextMovesTotal"in e&&n(5,d=e.nextMovesTotal),"aggNextMove"in e&&n(6,p=e.aggNextMove),"nextMovesArr"in e&&n(7,g=e.nextMovesArr),"nextMovesTotal2"in e&&n(8,v=e.nextMovesTotal2),"aggNextMove2"in e&&n(9,h=e.aggNextMove2),"nextMovesArr2"in e&&n(10,m=e.nextMovesArr2),"sizing"in e&&n(11,b=e.sizing)},e.$$.update=()=>{16&e.$$.dirty&&n(1,({san:r,count:o,fen:l,accCount:i,curves:s}=f),r,(n(13,o),n(4,f)),(n(14,i),n(4,f)),(n(12,s),n(4,f))),e.$$.dirty,e.$$.dirty,4096&e.$$.dirty&&n(0,a=s)},[a,r,x,function(e){return e.c?e.c:ut(c?{san:e.san}:{i:e.i})},f,d,p,g,v,h,m,b,s,o,i]}class xt extends pe{constructor(e){super(),de(this,e,bt,mt,i,{tooltipData:4,nextMovesTotal:5,aggNextMove:6,nextMovesArr:7,nextMovesTotal2:8,aggNextMove2:9,nextMovesArr2:10,sizing:11})}}function $t(e,t,n){const r=e.slice();return r[18]=t[n],r[20]=n,r}function yt(e,t,n){const r=e.slice();return r[18]=t[n],r[20]=n,r}function wt(t){let n,r;return{c(){n=A("text"),r=E("No games found"),k(n,"transform","translate(30,20)"),k(n,"class","svelte-lhg3t6")},m(e,t){$(e,n,t),m(n,r)},p:e,i:e,o:e,d(e){e&&y(n)}}}function Mt(e){let t,n,r=e[1],o=[];for(let t=0;t<r.length;t+=1)o[t]=At(yt(e,r,t));const l=e=>oe(o[e],1,1,(()=>{o[e]=null}));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=_()},m(e,r){for(let t=0;t<o.length;t+=1)o[t].m(e,r);$(e,t,r),n=!0},p(e,n){if(7174&n){let i;for(r=e[1],i=0;i<r.length;i+=1){const l=yt(e,r,i);o[i]?(o[i].p(l,n),re(o[i],1)):(o[i]=At(l),o[i].c(),re(o[i],1),o[i].m(t.parentNode,t))}for(te(),i=r.length;i<o.length;i+=1)l(i);ne()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)re(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)oe(o[e]);n=!1},d(e){w(o,e),e&&y(t)}}}function At(e){let t,n;return t=new gt({props:{data:e[18],i:e[20],sizing:e[12],nextMovesTotal:e[2],hideTooltip:e[11],showTooltip:e[10]}}),{c(){ae(t.$$.fragment)},m(e,r){ce(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.data=e[18]),4&n&&(r.nextMovesTotal=e[2]),t.$set(r)},i(e){n||(re(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Et(t){let n,r;return{c(){n=A("text"),r=E("No games found"),k(n,"transform","translate(-60,20)"),k(n,"class","svelte-lhg3t6")},m(e,t){$(e,n,t),m(n,r)},p:e,i:e,o:e,d(e){e&&y(n)}}}function Tt(e){let t,n,r=e[4],o=[];for(let t=0;t<r.length;t+=1)o[t]=_t($t(e,r,t));const l=e=>oe(o[e],1,1,(()=>{o[e]=null}));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=_()},m(e,r){for(let t=0;t<o.length;t+=1)o[t].m(e,r);$(e,t,r),n=!0},p(e,n){if(7216&n){let i;for(r=e[4],i=0;i<r.length;i+=1){const l=$t(e,r,i);o[i]?(o[i].p(l,n),re(o[i],1)):(o[i]=_t(l),o[i].c(),re(o[i],1),o[i].m(t.parentNode,t))}for(te(),i=r.length;i<o.length;i+=1)l(i);ne()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)re(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)oe(o[e]);n=!1},d(e){w(o,e),e&&y(t)}}}function _t(e){let t,n;return t=new gt({props:{data:e[18],i:e[20],sizing:e[12],nextMovesTotal:e[5],hideTooltip:e[11],showTooltip:e[10]}}),{c(){ae(t.$$.fragment)},m(e,r){ce(t,e,r),n=!0},p(e,n){const r={};16&n&&(r.data=e[18]),32&n&&(r.nextMovesTotal=e[5]),t.$set(r)},i(e){n||(re(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){ue(t,e)}}}function Ct(e){let t,n,r,o,l,i;return t=new xt({props:{sizing:e[12],tooltipData:e[9],aggNextMove:e[0],nextMovesArr:e[1],nextMovesTotal:e[2],aggNextMove2:e[3],nextMovesArr2:e[4],nextMovesTotal2:e[5]}}),{c(){ae(t.$$.fragment),n=A("text"),r=E("Other Move(s)"),k(n,"x",o=e[7]/2-20),k(n,"y",l=e[6]+18),k(n,"class","svelte-lhg3t6")},m(e,o){ce(t,e,o),$(e,n,o),m(n,r),i=!0},p(e,r){const s={};512&r&&(s.tooltipData=e[9]),1&r&&(s.aggNextMove=e[0]),2&r&&(s.nextMovesArr=e[1]),4&r&&(s.nextMovesTotal=e[2]),8&r&&(s.aggNextMove2=e[3]),16&r&&(s.nextMovesArr2=e[4]),32&r&&(s.nextMovesTotal2=e[5]),t.$set(s),(!i||128&r&&o!==(o=e[7]/2-20))&&k(n,"x",o),(!i||64&r&&l!==(l=e[6]+18))&&k(n,"y",l)},i(e){i||(re(t.$$.fragment,e),i=!0)},o(e){oe(t.$$.fragment,e),i=!1},d(e){ue(t,e),e&&y(n)}}}function kt(e){let t,n,r,o,l,i,s,a,c,u,f,d,p,g;const v=[Mt,wt],h=[];function b(e,t){return e[4].length>0?0:1}o=b(e),l=h[o]=v[o](e);const x=[Tt,Et],w=[];function E(e,t){return e[4].length>0?0:1}a=E(e),c=w[a]=x[a](e);let C=e[8]&&Ct(e),N=function(e){let t;return{c(){t=M("div"),k(t,"id","tooltip"),k(t,"display","none"),S(t,"position","absolute"),S(t,"display","none"),k(t,"class","svelte-lhg3t6")},m(e,n){$(e,t,n)},d(e){e&&y(t)}}}();return{c(){t=A("svg"),n=A("g"),r=A("g"),l.c(),i=A("g"),s=A("g"),c.c(),C&&C.c(),d=T(),N&&N.c(),p=_(),k(r,"transform","translate(0,"+e[13]+")"),k(n,"class","bars-1"),k(s,"transform","translate(0,"+e[13]+")"),k(i,"class","bars-2"),k(i,"transform",u="translate("+(e[7]-e[14])+",0)"),k(t,"width",e[7]),k(t,"height",f=e[6]+20),k(t,"class","svelte-lhg3t6")},m(e,l){$(e,t,l),m(t,n),m(n,r),h[o].m(r,null),m(t,i),m(i,s),w[a].m(s,null),C&&C.m(t,null),$(e,d,l),N&&N.m(e,l),$(e,p,l),g=!0},p(e,[n]){let d=o;o=b(e),o===d?h[o].p(e,n):(te(),oe(h[d],1,1,(()=>{h[d]=null})),ne(),l=h[o],l?l.p(e,n):(l=h[o]=v[o](e),l.c()),re(l,1),l.m(r,null));let p=a;a=E(e),a===p?w[a].p(e,n):(te(),oe(w[p],1,1,(()=>{w[p]=null})),ne(),c=w[a],c?c.p(e,n):(c=w[a]=x[a](e),c.c()),re(c,1),c.m(s,null)),(!g||128&n&&u!==(u="translate("+(e[7]-e[14])+",0)"))&&k(i,"transform",u),e[8]?C?(C.p(e,n),256&n&&re(C,1)):(C=Ct(e),C.c(),re(C,1),C.m(t,null)):C&&(te(),oe(C,1,1,(()=>{C=null})),ne()),(!g||128&n)&&k(t,"width",e[7]),(!g||64&n&&f!==(f=e[6]+20))&&k(t,"height",f)},i(e){g||(re(l),re(c),re(C),g=!0)},o(e){oe(l),oe(c),oe(C),g=!1},d(e){e&&y(t),h[o].d(),w[a].d(),C&&C.d(),e&&y(d),N&&N.d(e),e&&y(p)}}}function Nt(e,t,n){let r;u(e,he,(e=>n(17,r=e)));let o,l,{aggNextMove:i}=t,{nextMovesArr:s}=t,{nextMovesArrDict:a}=t,{nextMovesTotal:c}=t,{aggNextMove2:f}=t,{nextMovesArr2:d}=t,{nextMovesTotal2:p}=t,{nextMovesArrDict2:g}=t,{h:v}=t,{w:h}=t;const m={w:h,bw:50,h:v,th:0},{th:b,bw:x}=m;return e.$$set=e=>{"aggNextMove"in e&&n(0,i=e.aggNextMove),"nextMovesArr"in e&&n(1,s=e.nextMovesArr),"nextMovesArrDict"in e&&n(15,a=e.nextMovesArrDict),"nextMovesTotal"in e&&n(2,c=e.nextMovesTotal),"aggNextMove2"in e&&n(3,f=e.aggNextMove2),"nextMovesArr2"in e&&n(4,d=e.nextMovesArr2),"nextMovesTotal2"in e&&n(5,p=e.nextMovesTotal2),"nextMovesArrDict2"in e&&n(16,g=e.nextMovesArrDict2),"h"in e&&n(6,v=e.h),"w"in e&&n(7,h=e.w)},[i,s,c,f,d,p,v,h,o,l,function(e,{san:t,count:i,fen:s,accCount:u,prevFens:f}){be.set(t.slice(-2));let d,m=document.getElementById("tooltip");m.innerHTML=`${t} was played ${i} times (${Math.round(i/c*100)}%)`,m.style.display="block",m.style.left=e.pageX+10+"px",m.style.top=e.pageY+10+"px";const $=x,y=h-x,w=(e,t,n)=>(e-t/2)*v/n+b;if(f){const e=w(u,i,p);d=Object.entries(f).map((([t,n])=>{const{accCount:r,count:o,san:l,i:i}=a[t],s=w(r,o,c);return{x1:$,x2:y,y1:s,y2:e,san:l,i:i,t:n/p*v}}))}else{const e=["0","1","2","3"].reduce(((e,t)=>[...e,...r[t][s].nxt.map((e=>e[0]))]),[]),t=[...new Set(e)];let n=u-i,o=0;d=t.map(((e,t)=>{const r=g[e],l=r.count/p*v,i=w(r.accCount,r.count,p),s=n*v/c+l/2;return n+=r.count,o+=r.count,{x1:$,x2:y,y1:s,y2:i,t:l,san:r.san,i:r.i}}));const l=(i-o)/c*v,a=u*v/c-l/2;d.push({x1:$,x2:y/2,y1:a,y2:v+20-l/2,t:l,c:"gray"})}n(9,l={san:t,count:i,fen:s,accCount:u,prevFens:f,curves:d}),console.log({tooltipData:l}),n(8,o=!0)},function(){be.set(!1),document.getElementById("tooltip").style.display="none",n(8,o=!1)},m,b,x,a,g]}class St extends pe{constructor(e){super(),de(this,e,Nt,kt,i,{aggNextMove:0,nextMovesArr:1,nextMovesArrDict:15,nextMovesTotal:2,aggNextMove2:3,nextMovesArr2:4,nextMovesTotal2:5,nextMovesArrDict2:16,h:6,w:7})}}function Pt(e,t,n){const r=e.slice();return r[13]=t[n][0],r[14]=t[n][1],r[16]=n,r}function qt(e){let t,n,r,o=ct,l=[];for(let t=0;t<o.length;t+=1)l[t]=It(Pt(e,o,t));return{c(){t=M("div"),n=A("svg");for(let e=0;e<l.length;e+=1)l[e].c();k(n,"width",Lt),k(n,"height",r=20)},m(e,r){$(e,t,r),m(t,n);for(let e=0;e<l.length;e+=1)l[e].m(n,null)},p(e,t){if(0&t){let r;for(o=ct,r=0;r<o.length;r+=1){const i=Pt(e,o,r);l[r]?l[r].p(i,t):(l[r]=It(i),l[r].c(),l[r].m(n,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=o.length}},d(e){e&&y(t),w(l,e)}}}function It(t){let n,r,o,l,i,s=t[13]+"";return{c(){n=A("g"),r=A("rect"),o=A("text"),l=E(s),k(r,"cx","0"),k(r,"cy","10"),k(r,"height",15),k(r,"width",15),k(r,"fill",t[14]),k(o,"x","15"),k(o,"y","12"),k(n,"transform",i="translate("+65*t[16]+",0)")},m(e,t){$(e,n,t),m(n,r),m(n,o),m(o,l)},p:e,d(e){e&&y(n)}}}function Dt(e){let t,n,r,o,l,i,s,a,c,u,f,d,p;o=new St({props:{h:Ot,w:Lt,aggNextMove:e[0],nextMovesArr:e[1],nextMovesTotal:e[3],nextMovesArrDict:e[2],aggNextMove2:e[4],nextMovesArr2:e[5],nextMovesTotal2:e[7],nextMovesArrDict2:e[6]}});let g=e[8]&&qt(e);return{c(){t=M("div"),n=M("h1"),n.textContent="Distribution of Next Two Moves",r=T(),ae(o.$$.fragment),l=T(),i=M("div"),s=M("label"),a=M("input"),c=E("\r\n            Generate colors by piece (default is index)"),u=T(),g&&g.c(),k(n,"align","center"),k(n,"font-size","28"),S(n,"margin","0"),S(n,"padding","0"),k(a,"type","checkbox"),S(i,"display","flex"),S(i,"flex-direction","row"),k(t,"class","container svelte-1ssh6nf")},m(v,h){$(v,t,h),m(t,n),m(t,r),ce(o,t,null),m(t,l),m(t,i),m(i,s),m(s,a),m(s,c),m(t,u),g&&g.m(t,null),f=!0,d||(p=C(a,"click",e[10]),d=!0)},p(e,[n]){const r={};1&n&&(r.aggNextMove=e[0]),2&n&&(r.nextMovesArr=e[1]),8&n&&(r.nextMovesTotal=e[3]),4&n&&(r.nextMovesArrDict=e[2]),16&n&&(r.aggNextMove2=e[4]),32&n&&(r.nextMovesArr2=e[5]),128&n&&(r.nextMovesTotal2=e[7]),64&n&&(r.nextMovesArrDict2=e[6]),o.$set(r),e[8]?g?g.p(e,n):(g=qt(e),g.c(),g.m(t,null)):g&&(g.d(1),g=null)},i(e){f||(re(o.$$.fragment,e),f=!0)},o(e){oe(o.$$.fragment,e),f=!1},d(e){e&&y(t),ue(o),g&&g.d(),d=!1,p()}}}const Lt=380,Ot=720;function Rt(e,t,n){let r,o;u(e,he,(e=>n(11,r=e))),u(e,xe,(e=>n(8,o=e)));let l={},i=[],s={},a=0,c={},f=[],d={},p=0;const g=we.subscribe((e=>{console.log({newDataArr:e}),n(0,l=e.reduce(((e,t,n)=>{if(!t||!t.nxt)return{...e};let r={};return Object.entries(t.nxt).forEach((([t,n],o)=>{const l=n[0],i=n[1][0],s=n[1][1],a=e[l]?e[l][0]:0,c=parseInt(i)+a;r[l]=[c,s]})),{...e,...r}}),{}));let t=0;const o=Object.entries(l).sort(((e,t)=>t[1][0]-e[1][0])).map((([e,[n,r]])=>isNaN(n)?{san:r,count:0,accCount:0,fen:e}:(t+=n,{san:r,count:n,accCount:t,fen:e})));n(3,a=t);const u=o.filter((({fen:e,count:t})=>!0));n(1,i=[...u]),console.log("Parsed next move viz data:",{nextMovesArr:i,aggNextMove:l,nextMovesTotal:a}),n(2,s=i.reduce(((e,t,n)=>({...e,[t.fen]:{...t,i:n}})),{}));const g=i.map((({fen:e},t)=>{const n=["0","1","2","3"].map((t=>{const n=r[t][e];return null==n?(console.warn(`While checking future move 2: Fen (${e}) not recognized for level ${t}`),!1):n}));return{fenPrev:e,gameData:n}}));n(4,c=g.map((({fenPrev:e,gameData:t},n)=>t.reduce(((t,n,r)=>{if(!n)return t;let o={};return Object.entries(n.nxt).forEach((([n,r],l)=>{const i=r[0],s=r[1][1],a=t[i]?t[i].count:0,c=parseInt(r[1][0])+a;o[i]={count:c,san:s,fenPrev:e}})),{...t,...o}}),{}))).reduce(((e,t)=>(Object.keys(t).forEach((n=>{const r=t[n].count,o=t[n].fenPrev;n in e?t[n]={...t[n],count:r+e.count,prevFens:{...e[n].prevFens,[o]:r}}:t[n].prevFens={[o]:r}})),{...e,...t})),{})),t=0;const v=Object.entries(c).sort(((e,t)=>t[1].count-e[1].count)).map((e=>{const[n,{count:r,prevFens:o,san:l}]=e;return isNaN(r)?{san:l,count:0,accCount:0,fen:n,prevFens:[]}:(t+=r,{san:l,count:r,accCount:t,fen:n,prevFens:o})}));n(7,p=t),n(5,f=v),n(6,d=f.reduce(((e,t,n)=>({...e,[t.fen]:{...t,i:n}})),{})),console.log("Parsed 2 move viz data:",{nextMovesArr2:f,aggNextMove2:c,nextMovesTotal2:p})}));function v(e){xe.set(!e)}j(g);return[l,i,s,a,c,f,d,p,o,v,()=>v(o)]}class jt extends pe{constructor(e){super(),de(this,e,Rt,Dt,i,{})}}function Bt(t){let n,r,o,l=t[2]+"";return{c(){n=M("p"),r=E("While loading an error occurred: "),o=E(l),S(n,"color","red")},m(e,t){$(e,n,t),m(n,r),m(n,o)},p:e,i:e,o:e,d(e){e&&y(n)}}}function zt(t){let n,r,o,l,i,s,a;return r=new st({}),l=new Le({}),s=new jt({}),{c(){n=M("div"),ae(r.$$.fragment),o=T(),ae(l.$$.fragment),i=T(),ae(s.$$.fragment),k(n,"class","viz-container svelte-jmotdg")},m(e,t){$(e,n,t),ce(r,n,null),m(n,o),ce(l,n,null),m(n,i),ce(s,n,null),a=!0},p:e,i(e){a||(re(r.$$.fragment,e),re(l.$$.fragment,e),re(s.$$.fragment,e),a=!0)},o(e){oe(r.$$.fragment,e),oe(l.$$.fragment,e),oe(s.$$.fragment,e),a=!1},d(e){e&&y(n),ue(r),ue(l),ue(s)}}}function Kt(t){let n;return{c(){n=M("p"),n.textContent="Loading..."},m(e,t){$(e,n,t)},p:e,i:e,o:e,d(e){e&&y(n)}}}function Qt(e){let t,n,r,o,l,i,s,a,c;l=new Re({});let u={ctx:e,current:null,token:null,hasCatch:!0,pending:Kt,then:zt,catch:Bt,value:1,error:2,blocks:[,,,]};return function(e,t){const n=t.token={};function r(e,r,o,l){if(t.token!==n)return;t.resolved=l;let i=t.ctx;void 0!==o&&(i=i.slice(),i[o]=l);const s=e&&(t.current=e)(i);let a=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==r&&e&&(te(),oe(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),ne())})):t.block.d(1),s.c(),re(s,1),s.m(t.mount(),t.anchor),a=!0),t.block=s,t.blocks&&(t.blocks[r]=s),a&&X()}if((o=e)&&"object"==typeof o&&"function"==typeof o.then){const n=R();if(e.then((e=>{O(n),r(t.then,1,t.value,e),O(null)}),(e=>{if(O(n),r(t.catch,2,t.error,e),O(null),!t.hasCatch)throw e})),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}var o}(e[0],u),{c(){t=M("link"),n=M("html"),r=T(),o=M("main"),ae(l.$$.fragment),i=T(),u.block.c(),s=T(),a=M("p"),a.innerHTML='Build with Svelte. Visit the <a href="https://svelte.dev/tutorial">Svelte tutorial</a> to learn how to build Svelte apps.',document.title="Chess Viz",k(t,"rel","icon"),k(t,"type","image/svg"),k(t,"href","./img/chesspieces/wikipedia/wQ.png"),k(n,"lang","en")},m(e,f){m(document.head,t),m(document.head,n),$(e,r,f),$(e,o,f),ce(l,o,null),m(o,i),u.block.m(o,u.anchor=null),u.mount=()=>o,u.anchor=s,m(o,s),m(o,a),c=!0},p(t,[n]){!function(e,t,n){const r=t.slice(),{resolved:o}=e;e.current===e.then&&(r[e.value]=o),e.current===e.catch&&(r[e.error]=o),e.block.p(r,n)}(u,e=t,n)},i(e){c||(re(l.$$.fragment,e),re(u.block),c=!0)},o(e){oe(l.$$.fragment,e);for(let e=0;e<3;e+=1){oe(u.blocks[e])}c=!1},d(e){y(t),y(n),e&&y(r),e&&y(o),ue(l),u.block.d(),u.token=null,u=null}}}function Ft(e){return[fetch("games_2022_2M_filt10.json").then((e=>e.json())).then((e=>{he.set(e)}))]}return new class extends pe{constructor(e){super(),de(this,e,Ft,Qt,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
